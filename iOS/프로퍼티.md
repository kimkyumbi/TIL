# 230717-1 / SWIFT / 프로퍼티(Property)

프로퍼티는 무엇일까? 정의부터 살펴보자

```
프로퍼티는 클래스, 구조체, 열거형과 관련한 값이다. 
프로퍼티의 종류에는 저장 프로퍼티(Stored Properties)와 
계산된 프로퍼티(Computed Properties) 가 있다. 
저장 프로퍼티는 말 그대로 값을 저장하고 있는 프로퍼티이고,
계산된 프로퍼티는 값을 저장하고 있지 않고 특정하게 계산한 값을 반환해 주는 프로퍼티이다. 
계산된 프로퍼티는 클래스, 구조체, 열거형 모두에서 사용가능하지만, 
저장 프로퍼티는 클래스와 구조체에서만 사용 가능하다. 
추가로 프로퍼티 옵저버를 정의해서 값이 변할 때마다 모니터링할 수 있다.
```

좀 많이 길지만 일단 다음으로 넘어가자.

---

## 저장 프로퍼티 (Stored Properties)

저장 프로퍼티는 위에서 설명한 대로 단순히 값을 저장하고 있는 프로퍼티다. 

이 프로퍼티는 `let` 이나 `var`를 이용해서 상수나 변수로 선언해 사용할 수 있다.

```swift
struct KKB {
    var gsm: Int
    let msg: Int
}
var rangeOfThreeItems = KGB(gsm: 0, msg: 3)
// 범위 값은 0, 1, 2
rangeOfThreeItems.gsm = 5
// 범위 값은 5, 6, 7 
```
위 예제는 `gsm` 와  `msg` 에 첫 값과 그 길이를 각각의 프로퍼티에 저장해 범위 값을 표현한다.

---

### 상수 구조체 인스턴스의 저장 프로퍼티 (Stored Properties of Constant Structure Instances)
구조체를 상수로 선언하면(let) 그 구조체 인스턴스의 프로퍼티를 변경할 수 없다.
```swift
let rangeOfFourItems = KGB(gsm: 0, msg: 4)
// 범위 값은 0, 1, 2, 3 
rangeOfFourItems.gsm = 5
// 에러
```
위 예제에서 rangeOfFourItems는 상수(let)로 선언되었기 때문에 프로퍼티를 변경할 수 없다. 

반면 구조체가 아니라 클래스는 let으로 선언하더라도 프로퍼티가 변경 가능하다. 

이유는 클래스 인스턴스는 참조 타입 이기 때문이다.

---

### 지연 저장 프로퍼티 (Lazy Stored Properties)

지연 저장 프로퍼티는 값이 처음으로 사용 되기 전에는 계산되지 않는 프로퍼티이다.

지연 저장 프로퍼티로 선언하기 위해서는 프로퍼티의 선언 앞에 lazy 키워드를 붙이면 된다.

```swift
NOTE
지연 프로퍼티는 반드시 변수(var)로 선언해야 합니다. 
왜냐하면 상수는 초기화가 되기전에 항상 값을 같는 프로퍼티인데, 
지연 프로퍼티는 처음 사용되기 전에는 값을 갖지 않는 프로퍼티이기 때문입니다.
```
지연 프로퍼티는 프로퍼티가 특정 요소에 의존적이어서 그 요소가 끝나기 전에 

적절한 값을 알지 못하는 경우에 유용하다. 

또 복잡한 계산이나 부하가 많이 걸리는 작업을 지연 프로퍼티로 선언해 

사용하면 실제 사용되기 전에는 실행되지 않아서 인스턴스의 초기화 시점에 복잡한 계산을 피할 수 있다.

```
만약 지연 프로퍼티가 여러 스레드에서 사용되면 지연 프로퍼티가 한번만 실행되는 걸 보장하지 않다. 만약 지연 프로퍼티가 단일 스레드에서 사용되면 초기화는 한번만 하게 된다.
```

---

### 저장 프로퍼티와 인스턴스 변수 (Stored Properties and Instance Variables)

Objective-C에 경험이 있으신 분은 Objective-C 언어에서는 값을 저장하기 위해 점 연산자

(instance.property = value)나 set 연산(instance.setProperty(value))으로 

값을 저장한다는 것을 아실 거다. 뿐만 아니라 메모리 관리와 관련한 개념도 프로퍼티에 함께 명시한다. 

---

## 계산된 프로퍼티 (Computed Properties)

저장 프로퍼티를 뿐 아니라 추가적으로 클래스, 구조체, 열거형은 계산된 프로퍼티를 선언할 수 있다. 

이 계산된 프로퍼티는 실제 값을 저장하고 있는 것이 아니라 getter와 optional한 setter를 제공해 

값을 탐색하고 간접적으로 다른 프로퍼티 값을 설정할 수 있는 방법을 제공한다.

---

### 읽기전용 계산된 프로퍼티 (Read-Only Computed Properties)

getter만 있고 setter를 제공하지 않는 계산된 프로퍼티를 읽기전용 계산된 프로퍼티라고 한다. 

즉, 읽기전용 계산된 프로퍼티는 반드시 반환 값을 제공하고 다른 값을 지정할 수는 없는 프로퍼이다.

```swift
NOTE
읽기전용 계산된 프로퍼티를 포함해 계산된 프로퍼티를 선언시에는
반드시 let이 아니라 var로 선언해야한다. 
보통 읽기전용(read-only)이라 함은 한번 값이 정해지면 변하지 않기 때문에 
let으로 선언하는 것이 맞으나 계산된 프로퍼티는 읽기전용(read-only)이라 하더라도 
계산 값에 따라 값이 변할 수 있기 때문에 var로 선언한다.
```

---

## 전역변수와 지역변수 (Global and Local Variables)

앞서 소개한 계산된 프로퍼티와 프로퍼티 옵저버 기능은 전역변수와 지역변수 모두에서 이용 가능하다. 

전역 변수란 함수, 메소드, 클로저 혹은 타입 컨텍스트 밖에 정의된 변수이고 

지역 변수는 그 안에 선언된 변수를 말한다.

```swift
NOTE
전역 상수와 변수는 지연 저장 프로퍼티(Lazy Stored Properties)와 같이 
지연 계산(lazy computed) 된다. 하지만 지연 저장 프로퍼티와 다르게 
lazy키워드를 붙일 필요 없다. 반면 지역 상수와 변수는 지연 계산될 수 없다.
```

---

## 타입 프로퍼티 (Type Properties)
인스턴스 프로퍼티는 특정 인스턴스에 속한 프로퍼티를 말한다. 

이 프로퍼티는 새로운 인스턴스가 생성될 때마다 새로운 프로퍼티도 같이 생성된다. 

타입 프로퍼티는 특정 타입에 속한 프로퍼티로 그 타입에 해당하는 단 하나의 프로퍼티만 생성된다. 

이 타입 프로퍼티는 특정 타입의 모든 인스턴스에 공통으로 사용되는 값을 정의할때 유용하다.

```swift
NOTE
인스턴스 프로퍼티와는 다르게 타입 프로퍼티는 항상 초기값을 지정해서 사용해야 한다. 
왜냐하면 타입 자체에는 초기자(Initializer)가 없어 초기화 할 곳이 없기 때문이다.
```

---

### 타입 프로퍼티 구문 (Type Property Syntax)

타입 프로퍼티를 선언을 위해서는 static 키워드를 사용한다. 

클래스에서는 static과 class 이렇게 2가지 형태로 타입 프로퍼티를 선언할 수 있는데 

두 가지 경우의 차이는서브클래스에서 overriding가능 여부이다. 

class로 선언된 프로퍼티는 서브클래스에서 오버라이드 가능하다. 

---

### 타입 프로퍼티의 접근과 설정 (Querying and Setting Type Properties)

인스턴스 프로퍼티와 마찬가지로 타입 프로퍼티도 점연산자(dot operator)로 

프로퍼티의 값을 가져오고 할당할 수 있습니다.